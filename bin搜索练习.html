<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>bin search</title>

    <style type="text/css">
        body {
            background-color: #333;
        }

        .bg-div {
            margin: 0 auto;
            width: 1366px;
            height: 768px;
            background-image: url(http://img.mukewang.com/52da5e7d0001c0f813660768.jpg);
            position: relative;
        }

        .logo {
            float: left;
            background: url(http://img.mukewang.com/52da5e530001eea901070053.jpg) no-repeat;
            margin: -4px 18px 0 0;
            height: 53px;
            width: 107px;
        }

        .search-wrap {
            float: left;
            background-color: #fff;
            width: 407px;
            padding: 5px;
        }

        #search_input {
            float: left;
            border: 0;
            font-size: 100%;
            width: 375px;
            outline: none;
            height: 29px;
        }

        .search-submit {
            float: left;
            width: 29px;
            height: 29px;
            background: transparent url(http://img.mukewang.com/52da5df800012b1e02220137.jpg) no-repeat -30px -107px;
            border: 0;
        }

        #search-box {
            width: 560px;
            height: 60px;
            margin: 0 auto;
            position: relative;
            top: 20%;
        }

        /*设置搜索建议的CSS*/
        .suggest {
            width: 417px;
            background-color: #fff;
            margin: 0;
            padding: 0;
            border: 1px solid #999;
        }

        .suggest ul {
            list-style: none;
            display: block;
            margin: 0;
            padding: 0;
        }

        .suggest ul li {
            padding: 3px;
            line-height: 25px;
            font-size: 14px;
            color: #777;
            cursor: pointer;
        }

        .suggest strong {
            color: #000;
        }


    </style>

    <script type="text/javascript">

        var getDOM = function (id) {
            return document.getElementById(id);
        };

        /*
        var addEvent = function (id, event, fn) {
            var el = getDOM(id) || document;
            if (el.addEventListener) {
                el.addEventListener(event, fn, false);
            } else {
                alert("绑定监听事件失败!");
            }
        };
        */

        var getElementLeft = function (element) {
            var actualLeft = element.offsetLeft;
            var current = element.offsetParent;

            while (current !== null) {
                actualLeft += current.offsetLeft;
                current = current.offsetParent;
            }
            return actualLeft;
        };

        var getElementTop = function (element) {
            var actualTop = element.offsetTop;
            var current = element.offsetParent;

            while (current !== null) {
                actualTop += current.offsetTop;
                current = current.offsetParent;
            }
            return actualTop;
        };

        window.onload = function () {

            /*两种不同方法添加事件*/
            getDOM('search_input').onkeyup = function () {

                var searchText = getDOM('search_input').value;
                //获取输入框的值

                ajaxGet('http://localhost/web/suggest?q=' + searchText, function (text) {
                    var jsonObj = JSON.parse(text);
                    var html = "<ul>";
                    for (var i = 0; i < jsonObj.res.length; i++) {
                        html += '<li>' + jsonObj.res[i] + '</li>';
                    }
                    html += '</ul>';
                    getDOM('search-suggest').innerHTML = html;
                    getDOM('search-suggest').style.top = getElementTop(getDOM("search-form")) + 41 + "px";
                    getDOM('search-suggest').style.left = getElementLeft(getDOM("search-form")) - 1 + "px";
                    getDOM('search-suggest').style.position = "absolute";
                    getDOM("search-suggest").style.display = "block";
                });

            };

            document.getElementById('search_input').addEventListener("blur", function () {
                getDOM("search-suggest").style.display = "none";
            });


        };


        /*AJAX请求*/
        var ajaxGet = function (url, callback) {
            var _xhr = null;
            if (window.XMLHttpRequest) {
                _xhr = new window.XMLHttpRequest();
            } else if (window.ActiveXObject) {
                _xhr = new ActiveXObject("Msxml2.XMLHTTP");
            }
            _xhr.onreadystatechange = function () {
                if (_xhr.readyState === 4 && _xhr.status === 200) {
                    callback(_xhr.responseText);
                }
            };
            _xhr.open('get', url, false);
            _xhr.send(null);
        };

    </script>


</head>
<body>
<div class="bg-div">
    <div id="search-box">
        <div class="logo"></div>
        <form target="_blank" method="get" class="search-wrap" id="search-form">
            <input placeholder="搜索..." id="search_input" type="text" autocomplete="off">
            <input class="search-submit" type="submit" value=""/>
        </form>
    </div>
</div>

<div class="suggest" id="search-suggest" style="display: none">
    <ul id="search-result">
        <li>搜索内容1</li>
        <li>搜索内容2</li>
    </ul>

</div>

</body>
</html>